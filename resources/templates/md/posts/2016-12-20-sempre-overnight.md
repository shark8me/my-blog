{:title "Experiments with building a semantic parser with Sempre"
 :layout :post
 :page-index 0
 :draft? false
 :tags ["" "Sempre"]
 }


In the next few posts, I'm going to attempt building a semantic parser with the [Sempre toolkit](https://github.com/percyliang/sempre/blob/master/TUTORIAL.md). 
The Sempre toolkit is used as a framework for several papers. In the rest of this discussion, we will be focus on the paper ["Building semantic parsers overnight"](http://nlp.stanford.edu/pubs/wang-berant-liang-acl2015.pdf)

Building the "overnight" parser needs 4 steps:

* Declare a lexicon: In this stage, declare the key words & phrases, along with a basic grammar describing how these phrases will compose. The recipes.grammar is an example that uses words from the recipes domain
* Generate canonical utterances: In this stage, the sempre framework generates canonical utterances such as "recipe that requires the most number of ingredient". The framework creates this list using a domain-general grammar, the lexicon and the dataset <TODO>.
* Generate natural utterances: Using AMTs (Amazon Mechanical Turk) workers, get a list of natural utterances that correspond to the canonical utterance. E.g. "Which recipe calls for the most ingredients". 
* Train the parser using the set of canonical & natural utterances.


Building an parser requires the following data inputs. We'll continue to use the recipes dataset as a starting example:

### recipes.paraphrases.groups  

This file contains the original utterance, and a set of similar utterances created by AMT (Amazon Mechanical Turk) workers. The first few lines are similar to:

```
original - recipe whose posting date is at least posting date of rice pudding
para - recipes posted with or after posting rice pudding, worker - A2TUNPP2GOQ1N3
para - recipe whose posting date is at least rice puddings posting date, worker - A1ULLPIT6EU99K
para - what recipe was posted after or on the same day as rice pudding, worker - A32CIL5S21Y4MR
```

### recipes.paraphrases.test.examples  
### recipes.paraphrases.train.examples  

Each instance is an example of the utterance, the original phase and the parsed form called a derivation. Train and test data have the same format.

```
(example
  (utterance "what meal has two or fewer recipes designated for it")
    (original "meal that at most two recipe is for")
      (targetFormula 
          (call edu.stanford.nlp.sempre.overnight.SimpleWorld.listValue (call edu.stanford.nlp.sempre.overnight.SimpleWorld.countComparative (call edu.stanford.nlp.sempre.overnight.SimpleWorld.getProperty (call edu.stanford.nlp.sempre.overnight.SimpleWorld.singleton en.meal) (string !type)) (call edu.stanford.nlp.sempre.overnight.SimpleWorld.reverse (string meal)) (string <=) (number 2) (call edu.stanford.nlp.sempre.overnight.SimpleWorld.getProperty (call edu.stanford.nlp.sempre.overnight.SimpleWorld.singleton en.recipe) (string !type)))))) 
```

### recipes.phrase_alignments  
This file describes pairs of uni/bi-grams, with word and phrase alignments between canonical and natural utterances, are scored with a numerical value. Listed below are a few high-scoring alingments .

```
requires milk:require milk    9.0
show me recipes that:recipe whose    13.0
less than two recipe:fewer than two recipes  5.0
```

### recipes-ppdb.txt  
This file is generated by the framework using PPDB, and is used to get the paraphrased entries.  

### recipes.word_alignments.berkeley

This file has word alignments with scores 

```
prepare	preparation	1.0
without	not	1.0
lesser	smaller	1.0
prep	preparation	1.0
represented	number	1.0
recent	largest	1.0
```






